<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>Xmas Wish Tree - è“ç™½ç²’å­ç‰ˆ</title>
<style>
body{
  margin:0;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  overflow:hidden;
  font-family:"æ¥·ä½“","KaiTi",cursive;
  background:
    radial-gradient(circle at 20% 80%, rgba(255,140,66,.6), transparent 65%),
    radial-gradient(circle at 80% 20%, rgba(0,150,136,.3), transparent 50%),
    radial-gradient(circle at 40% 60%, #ff9d5c 0%, #3a1c71 35%, #1a2a6c 70%, #0d1b2a 100%);
  background-size:200% 200%;
  animation:bgMove 14s ease-in-out infinite;
}
@keyframes bgMove{
  0%{background-position:0% 50%}
  50%{background-position:100% 50%}
  100%{background-position:0% 50%}
}
.bg-snow{
  position:fixed;
  top:-20px;
  pointer-events:none;
  z-index:1;
  animation:fall linear infinite;
}
@keyframes fall{to{transform:translateY(110vh) rotate(360deg);}}
.tree{
  position:relative;
  width:560px;
  height:680px;
  z-index:10;
}
.star-top{
  position:absolute;
  top:28px;
  left:50%;
  transform-style:preserve-3d;
  transform:translateX(-50%) rotateX(22deg);
  font-size:48px;
  color:#ffec8b;
  text-shadow:0 0 16px rgba(255,215,0,.8);
  transition:transform 2.3s linear;
  z-index:30;
}

.star-top::after{
  content:"â˜…";
  position:absolute;
  top:2px;
  left:2px;
  color:#c9a93f;
  transform:translateZ(-6px);
  filter:blur(1px);
  opacity:.9;
}



.star-message{
  position:absolute;
  top:20px;
  left:50%;
  transform:translateX(-50%);
  font-size:18px;
  color:#ffec8b;
  text-shadow:0 0 6px rgba(255,255,255,0.8);
  z-index:40;
  font-weight:bold;
  text-align:center;
  font-family:"Segoe Script","æ¥·ä½“","KaiTi",cursive;
}
.developed-by{
  position:absolute;
  bottom:90px;
  left:50%;
  transform:translateX(-50%);
  font-size:10px;
  color:#fff;
  opacity:0.5;
  text-align:center;
  z-index:40;
  font-family:"æ¥·ä½“","KaiTi",cursive;
}
.dot{
  position:absolute;
  transition: transform 2.3s cubic-bezier(.16,1,.3,1), opacity 2.3s ease;
  opacity:.6;
  z-index:6;
}
.dot.snow{
  width:4px; height:4px;
  border-radius:50%;
  background:#ffd27d;
  box-shadow:0 0 6px rgba(255,200,120,.8);
}
.dot.star{
  font-size:12px;
  color:#7a1f2b;
  text-shadow:0 0 6px rgba(160,40,40,.8);
}
.dot.big-star{
  font-size:14px;
  color:#b11226;
  text-shadow:0 0 8px rgba(200,30,40,.9);
}
.dot.breathe{animation:breathe 3s ease-in-out infinite;}
@keyframes breathe{0%,100%{opacity:.35} 50%{opacity:1}}

.dot-floating{
  position:absolute;
  border-radius:50%;
  z-index:2;
  opacity:0.4;

  animation-name: twinkle;
  animation-timing-function: ease-in-out;
  animation-iteration-count: infinite;
}
@keyframes twinkle {
  0%   { opacity: 0.25; transform: scale(0.9); }
  50%  { opacity: 1;    transform: scale(1.15); }
  100% { opacity: 0.35; transform: scale(1); }
}

#wishText{
  position:absolute; left:50%; top:410px;
  transform:translateX(-50%);
  font-size:34px; font-style:italic;
  color:#ffec8b; text-shadow:0 0 8px red;
  opacity:0; transition:opacity .4s ease; z-index:35;
}
#geoText{
  position:absolute; left:50%; top:470px;
  transform:translateX(-50%);
  font-size:18px; color:#ffec8b; text-shadow:0 0 8px red;
  opacity:0; transition:opacity .4s ease; z-index:35;
}

#blessingText{
  position:absolute;
  left:50%;
  top:510px;
  transform:translateX(-50%) translateY(0);

  font-size:18px;
  line-height:1.6;
  font-style:italic;

  font-family:
    "Comic Sans MS",
    "Segoe Print",
    "Bradley Hand",
    "PingFang SC",
    "Hiragino Sans GB",
    "Microsoft YaHei",
    cursive;

  color:#2b5d7a;

  /* âœï¸ æ‰‹ç»˜æè¾¹ */
  text-shadow:
    -1px -1px 0 #ffffff,
     1px -1px 0 #ffffff,
    -1px  1px 0 #ffffff,
     1px  1px 0 #ffffff,
     0   0   6px rgba(255,255,255,.85);

  /* ğŸ“„ çº¸å¼ çº¹ç†èƒŒæ™¯ */

  background: 
  linear-gradient(rgba(255,255,255,0.65), rgba(255,255,255,0.55)), 
  url("./assets/paper1.jpg") no-repeat center/cover;



  padding: 12px 20px;
  border-radius: 16px 18px 14px 20px;

  box-shadow:
    0 6px 14px rgba(0,0,0,.18),
    inset 0 0 0 2px rgba(255,255,255,.55),
    inset 0 -1px 0 rgba(0,0,0,.05);
  opacity:0;
  transition:opacity 0.6s ease, transform 0.8s ease;
  z-index:35;

  white-space:pre-wrap;
  text-align:center;
  max-width: 360px;
}

.wish-box{
  position:absolute; bottom:20px; left:50%;
  transform:translateX(-50%); text-align:center; z-index:40;
}
.row{display:flex;gap:6px;}
input{
  width:240px; padding:6px 12px;
  border-radius:20px; border:none; background:rgba(128,0,0,.6); color:#fff;
}
button{
  padding:6px 14px; border-radius:14px; border:none;
  background:#8b0000; color:#fff; cursor:pointer;
}
.disclaimer{
  margin-top:6px; font-size:10px; color:#fff; opacity:.80;
}
</style>
</head>
<body>

<div class="star-message" id="starMessage">Hello there æ¥è®¸æ„¿å§ï¼</div>
<div class="tree" id="tree">
  <div class="star-top" id="star">â˜…</div>
</div>

<div id="wishText">Merry Christmas</div>
<div id="geoText"></div>
<div id="blessingText"></div>
<div class="developed-by">Developed by Chloe & GPT</div>

<div class="wish-box">
  <div class="row">
    <input id="wishInput" placeholder="Type your wishâ€¦">
    <button id="sendBtn">SEND</button>
  </div>
  <div class="disclaimer">
    â˜… Your wish is your own, we donâ€™t record personal info â˜…<br>
    â˜… Address shown only for display â˜…
  </div>
</div>

<script>
const tree = document.getElementById('tree');
const CENTER = 280, TOP = 110, BOTTOM = 600, R = 190;

// ====== çº¢é»„ç²’å­ ======
const dots = [];
for (let i = 0; i < 300; i++) {
  const t = Math.random();
  const y = BOTTOM - t * (BOTTOM - TOP);
  const radius = R * (1 - t);
  const angle = t * Math.PI * 8;
  const x = CENTER + Math.cos(angle) * radius + (Math.random() - 0.5) * 18;

  const d = document.createElement('div');
  const rand = Math.random();
  if (rand < 0.5) { d.className = 'dot snow breathe'; }
  else if (rand < 0.75) { d.className = 'dot star breathe'; d.textContent = 'âœ¦'; }
  else { d.className = 'dot big-star breathe'; d.textContent = 'â˜…'; }

  d.style.left = x + 'px';
  d.style.top = y + 'px';
  tree.appendChild(d);
  dots.push(d);
}

// ====== è“ç™½çª„ä¸‰è§’ç²’å­ ======
const TRIANGLE_TOP = 110, TRIANGLE_BOTTOM = 600, TRIANGLE_WIDTH = 180;
const PARTICLE_COUNT = 250, PARTICLE_MIN_SIZE = 4, PARTICLE_MAX_SIZE = 8;
const floatingDots = [];
for (let i = 0; i < PARTICLE_COUNT; i++) {
  const t = Math.random();
  const y = TRIANGLE_TOP + t * (TRIANGLE_BOTTOM - TRIANGLE_TOP);
  const halfWidth = t * TRIANGLE_WIDTH / 2;
  const x = CENTER + (Math.random() * 2 - 1) * halfWidth;
  const size = PARTICLE_MIN_SIZE + Math.random() * (PARTICLE_MAX_SIZE - PARTICLE_MIN_SIZE);

  const f = document.createElement('div');
  f.className = 'dot-floating';
  f.style.left = x + 'px';
  f.style.top = y + 'px';
  f.style.width = size + 'px';
  f.style.height = size + 'px';
  f.style.backgroundColor = Math.random() < 0.5 ? '#ffffff' : '#a0d0ff';
  const duration = 1.8 + Math.random() * 2.4;
  const delay = Math.random() * 3;
  f.style.animationDuration = duration + 's';
  f.style.animationDelay = delay + 's';
  tree.appendChild(f);
  floatingDots.push(f);
}

// ====== æ•£å¼€ / å›æ”¶ ======
function scatter() {
  dots.forEach(d => {
    const a = Math.random() * Math.PI * 2;
    const dist = 400 + Math.random() * 200;
    d.style.transform = `translate(${Math.cos(a) * dist}px,${Math.sin(a) * dist}px) scale(.3)`;
    d.style.opacity = 0;
  });
}

function regroup() {
  dots.forEach(d => {
    d.style.transform = 'translate(0,0) scale(1)';
    d.style.opacity = 0.6;
  });
}

// ====== è“ç™½ç²’å­äº®åº¦è”åŠ¨ ======
function updateFloatingBrightness(count) {
  const ratio = Math.min(count / 30, 1);
  floatingDots.forEach(f => f.style.opacity = 0.3 + 0.7 * ratio);
}

// ====== æµæ˜Ÿ ======
function meteor() {
  for (let i = 0; i < 6; i++) {
    const m = document.createElement('div');
    m.textContent = 'âœ¦';
    m.style.position = 'absolute';
    m.style.left = '280px'; m.style.top = '560px';
    m.style.color = 'gold';
    m.style.transition = 'transform 2.3s linear,opacity 2.3s';
    tree.appendChild(m);
    setTimeout(() => {
      m.style.transform = 'translate(0,-500px)';
      m.style.opacity = 0;
      setTimeout(() => m.remove(), 2400);
    }, i * 100);
  }
}

// ====== éšæœºç¥ç¦ ======
const blessings = [
  "Have yourself a merry little Christmas, let your heart be light. â€” Frank Sinatra",
  "All I want for Christmas is you. â€” Mariah Carey",
  "A very Merry Christmas and a happy New Year. Letâ€™s hope itâ€™s a good one, without any fear. â€” John Lennon",
  "Somewhere in my memory, all of the music, all of the magic. â€” John Williams",
  "Christmas is a bridge. We need bridges as the river of time flows past. â€” Gladys Taber",
  "Winter is the time for comfort, for good food and warmth. â€” Edith Sitwell",
  "Even the darkest night will end and the sun will rise. â€” Les MisÃ©rables",
  "In the depths of winter, I finally learned that within me there lay an invincible summer. â€” Albert Camus",
  "æ„¿è¿™ä¸ªå†¬å¤©çš„æ‰€æœ‰é—æ†¾ï¼Œéƒ½æ˜¯æ˜¥å¤©æƒŠå–œçš„é“ºå«ã€‚",
  "å²æœ«å°†è‡³ï¼Œå¹³å®‰å–œä¹ã€‚",
  "åœ¨è¿™ä¸ªé›ªè½ä¸‹çš„å­£èŠ‚ï¼Œæ„¿æ‰€æœ‰çš„ç¾å¥½ä¸æœŸè€Œè‡³ã€‚",
  "äººé—´çƒŸç«æ°”ï¼Œæœ€æŠšå‡¡äººå¿ƒã€‚",
  "ä½•å…¶æœ‰å¹¸ï¼Œå¹´å²å¹¶è¿›ã€‚",
  "ä¸‡ç‰©æ›´æ–°ï¼Œæ—§ç–¾å½“æ„ˆã€‚",
  "å²å²å¸¸æ¬¢æ„‰ï¼Œå¹´å¹´çš†èƒœæ„ã€‚",
  "è¿™ä¸€å¹´è¾›è‹¦äº†ï¼Œæ„¿ä½ æ¥ä¸‹æ¥çš„æ—¥å­è¢«å¥½è¿åŒ…å›´ã€‚",
  "Warmest wishes for a cozy season.",
  "Sending you a giant hug.",
  "May your cocoa be hot and your worries be few.",
  "Peace, love, and joy to you.",
  "Wishing you a season of magic.",
  "Make it a December to remember.",
  "Stay warm and be happy.",
  "Joy to your world.",
  "Like snowflakes, each memory is unique.",
  "Let the stillness of winter bring you peace.",
  "Finding beauty in the frost.",
  "Beneath the starry sky, we are all connected.",
  "May you find light in the shortest day of the year.",
  "The best is yet to come.",
  "Your light makes the season brighter.",
  "Believe in the magic of new beginnings.",
  "May you find strength in the quiet.",
  "A toast to health and happiness.",
  "Peace begins with a smile.",
  "Spread kindness like confetti.",
  "May your heart find its home.",
  "Hope is the only thing stronger than fear.",
  "Holiday calories donâ€™t count.",
  "Iâ€™m only here for the cookies.",
  "Sleigh all day.",
  "Wake me up when itâ€™s 2026.",
  "More wine, less whining.",
  "But first, letâ€™s have some tea.",
  "Wrapped in love (and a little bit of stress).",
  "Cherish the people who make you feel seen.",
  "May you be gentle with yourself.",
  "The gift of presence is better than any present.",
  "Love is the language of the season.",
  "The world needs your unique magic."
];

function randomBlessing() {
  return blessings[Math.floor(Math.random() * blessings.length)];
}

// ====== æ¯æ—¥è®¡æ•° ======
const MAX_WISHES_PER_DAY = 30;
const today = new Date().toISOString().split('T')[0];
let wishesToday = parseInt(localStorage.getItem(`wishes_${today}`), 10) || 0;

function canWish() {
  // return wishesToday < MAX_WISHES_PER_DAY; // åŸé€»è¾‘
  return true; // æš‚æ—¶å…è®¸æ— é™æ¬¡
}

function recordWish() {
  wishesToday = (wishesToday || 0) + 1;
  localStorage.setItem(`wishes_${today}`, wishesToday);
}

// ====== å‘é€é€»è¾‘ ======
const sendBtn = document.getElementById('sendBtn');
const input = document.getElementById('wishInput');
const wishText = document.getElementById('wishText');
const geoText = document.getElementById('geoText');
const blessingText = document.getElementById('blessingText');

function sendWishHandler() {
  if (!input.value.trim()) return;
  input.value = '';

  if (!canWish()) {
    blessingText.textContent = "æ„¿æœ›å¤ªå¤šäº†ï¼Œæ˜å¤©å†æ¥åšæ¢¦ï¼";
    blessingText.style.opacity = 1;
    blessingText.style.transform = 'translateX(-50%) translateY(-10px)';
    setTimeout(() => {
      blessingText.style.opacity = 0;
      blessingText.style.transform = 'translateX(-50%) translateY(0)';
    }, 4000);
    return;
  }

  recordWish();
  updateFloatingBrightness(wishesToday);

  meteor();
  scatter();
  wishText.style.opacity = 1;

  fetch('https://ipapi.co/json/')
    .then(r => r.json())
    .then(d => {
      geoText.textContent = `[${d.longitude >= 0 ? 'E' : 'W'} ${Math.abs(d.longitude).toFixed(2)}Â°, ${d.latitude >= 0 ? 'N' : 'S'} ${Math.abs(d.latitude).toFixed(2)}Â°]`;
      geoText.style.opacity = 1;
      blessingText.textContent = randomBlessing();
      blessingText.style.opacity = 1;
      blessingText.style.transform = 'translateX(-50%) translateY(-10px)';
    });

  setTimeout(() => {
    wishText.style.opacity = 0;
    geoText.style.opacity = 0;
    blessingText.style.opacity = 0;
    blessingText.style.transform = 'translateX(-50%) translateY(0)';
    regroup();
  }, 4000);
}

sendBtn.onclick = sendWishHandler;
input.addEventListener('keydown', e => { if (e.key === 'Enter') sendWishHandler(); });

// ====== èƒŒæ™¯é›ªèŠ± ======
['#ffffff', '#a0d0ff'].forEach(color => {
  for (let i = 0; i < 30; i++) {
    const s = document.createElement('div');
    s.className = 'bg-snow';
    s.textContent = 'â„';
    s.style.color = color;
    s.style.left = Math.random() * 100 + 'vw';
    s.style.fontSize = 10 + Math.random() * 16 + 'px';
    s.style.opacity = 0.3 + Math.random() * 0.6;
    s.style.animationDuration = 6 + Math.random() * 6 + 's';
    s.style.animationDelay = Math.random() * 5 + 's';
    document.body.appendChild(s);
  }
});

</script>
</body>
</html>

